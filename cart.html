<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>YELLOW BASKET â€” CD-R King Checkout</title>
<link rel="icon" href="assets/img/yellow-basket-logo.png"/>
<style>
:root{--bg:#f2f4f8;--accent:#0078d7;--muted:#333}
html,body{margin:0;min-height:100%;background:var(--bg);font-family:Arial,Helvetica,sans-serif;color:var(--muted)}
.wrap{max-width:920px;margin:32px auto;padding:18px}
.header{display:flex;align-items:center;gap:12px}
.header img{width:80px;image-rendering:pixelated}
.header h1{margin:0;color:#0b7a4d}
.layout{display:grid;grid-template-columns:1fr 320px;gap:18px;margin-top:12px}
@media(max-width:880px){ .layout{grid-template-columns:1fr} }
.items{background:#fff;padding:12px;border-radius:8px}
.sidebar{background:#fff;padding:12px;border-radius:8px}
.item{display:flex;align-items:center;gap:10px;padding:8px 0;border-bottom:1px dashed #eee}
.thumb{width:56px;height:46px;display:grid;place-items:center;background:#def;border-radius:6px}
.meta b{display:block}
.total{font-weight:800;margin-top:12px;text-align:right}
input[type=text],textarea{width:100%;padding:8px;border:1px solid #ccc;border-radius:6px;margin-top:6px}
.pay-list{display:flex;flex-direction:column;gap:8px;margin-top:12px}
.pay-opt{padding:10px;border-radius:8px;border:1px solid #ddd;cursor:pointer;background:#f8f8f8}
.pay-opt[data-selected="true"]{outline:2px solid rgba(0,120,215,.14);box-shadow:0 8px 18px rgba(0,0,0,.06)}
.btn{display:inline-block;padding:10px 14px;border-radius:8px;background:#ffd54f;border:none;font-weight:800;cursor:pointer}
.footer{margin-top:18px;color:#666;font-size:13px;text-align:center}
</style>
</head>
<body>
  <div class="wrap">
    <div class="header">
      <img src="assets/img/yellow-basket-logo.png" alt="logo">
      <div>
        <h1>YELLOW BASKET - NETOPIA SUKI MARKET</h1>
        <div style="font-size:13px;color:#888">2ND FLOOR â€¢ SAN PEDRO BRANCH</div>
      </div>
    </div>

    <div class="layout">
      <section class="items" id="cartItems">
        <!-- dynamic items injected here -->
      </section>

      <aside class="sidebar">
        <div>
          <label><strong>Name</strong></label>
          <input type="text" id="buyerName" placeholder="Juan Dela Cruz">
        </div>
        <div style="margin-top:10px">
          <label><strong>Address</strong></label>
          <textarea id="buyerAddr" rows="3" placeholder="Purok / Barangay / City"></textarea>
        </div>

        <div style="margin-top:12px">
          <label><strong>Mode of Payment</strong></label>
          <div class="pay-list" id="payList">
            <div class="pay-opt" data-method="Gcrash">Gcrash</div>
            <div class="pay-opt" data-method="Crash Out">Crash Out</div>
            <div class="pay-opt" data-method="PayMoLater">PayMoLater</div>
            <div class="pay-opt" data-method="Bank Transfer">Bank Transfer (Fake)</div>
            <div class="pay-opt" data-method="COD">COD â€” Cry On Delivery</div>
          </div>
        </div>

        <div class="total" id="cartTotal">Total: â‚±0.00</div>
        <div style="margin-top:12px;display:flex;gap:8px">
          <button class="btn" id="fakeCheckout">Complete Purchase</button>
          <a href="index.html" style="display:inline-block;padding:10px 14px;border-radius:8px;background:#eee;text-decoration:none;color:#333">Continue Shopping</a>
        </div>
      </aside>
    </div>

    <div class="footer">SERVER: ESC Biennale - Tambay - Low Bandwidth Dreams - British Council â€” CD-R King approved peripherals only</div>
  </div>

<script>
/* cart rendering + interactions */
function getCart(){ try{ return JSON.parse(localStorage.getItem('yb_cart')||'[]'); }catch(e){return [];} }
function saveCart(c){ localStorage.setItem('yb_cart', JSON.stringify(c)); }

function renderCart(){
  const items = getCart();
  const container = document.getElementById('cartItems');
  const totalEl = document.getElementById('cartTotal');
  container.innerHTML = '';
  if(!items.length){
    container.innerHTML = '<p style="color:#777">ðŸ›’ Walang laman ang cart. Pumunta sa Start Shopping.</p>';
    totalEl.textContent = 'Total: â‚±0.00';
    return;
  }
  let sum = 0;
  items.forEach((it, idx)=>{
    const row = document.createElement('div'); row.className='item';
    row.innerHTML = `<div class="thumb">${it.thumb||'ðŸ§º'}</div>
      <div class="meta"><b>${it.name}</b><div style="color:#666;font-size:13px">${it.info}</div></div>
      <div style="margin-left:auto;text-align:right">
        <div>â‚±${(it.price||0).toFixed(2)}</div>
        <div style="font-size:13px;margin-top:6px">
          Qty: <input type="number" min="1" value="${it.qty||1}" data-idx="${idx}" style="width:56px;padding:4px;border:1px solid #ccc;border-radius:6px">
          <button data-rm="${idx}" style="margin-left:6px;padding:6px;border-radius:6px">Remove</button>
        </div>
      </div>`;
    container.appendChild(row);
    sum += (it.price||0)*(it.qty||1);
  });
  totalEl.textContent = `Total: â‚±${sum.toFixed(2)}`;

  // attach qty change
  container.querySelectorAll('input[type=number]').forEach(inp=>{
    inp.addEventListener('change', ()=>{
      const i = Number(inp.dataset.idx); const v = Math.max(1, Number(inp.value)||1);
      const arr = getCart(); arr[i].qty = v; saveCart(arr); renderCart();
    });
  });
  container.querySelectorAll('[data-rm]').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const i = Number(btn.dataset.rm); const arr = getCart(); arr.splice(i,1); saveCart(arr); renderCart();
    });
  });
}
renderCart();

/* payment selection */
document.getElementById('payList').addEventListener('click', (e)=>{
  const opt = e.target.closest('.pay-opt'); if(!opt) return;
  document.querySelectorAll('.pay-opt').forEach(o=>o.removeAttribute('data-selected'));
  opt.setAttribute('data-selected','true');
});

/* checkout */
document.getElementById('fakeCheckout').addEventListener('click', ()=>{
  const items = getCart();
  if(!items.length){ alert('Cart is empty.'); return; }
  const name = document.getElementById('buyerName').value || 'Anonymous';
  const addr = document.getElementById('buyerAddr').value || 'Unspecified Purok';
  const method = document.querySelector('.pay-opt[data-selected="true"]')?.dataset.method || 'Gcrash';
  const total = items.reduce((s,it)=>s + (it.price||0)*(it.qty||1), 0);
  const order = { id: 'YB-'+Math.floor(Math.random()*900000), name, addr, method, items, ts: Date.now(), total };
  localStorage.setItem('yb_last_order', JSON.stringify(order));
  localStorage.removeItem('yb_cart');
  // small beep then redirect to receipt
  try{ const ac = new (window.AudioContext||window.webkitAudioContext)(); const o=ac.createOscillator(), g=ac.createGain(); o.type='triangle'; o.frequency.value=880; g.gain.value=0.05; o.connect(g); g.connect(ac.destination); o.start(); o.stop(ac.currentTime+0.15);}catch(e){}
  setTimeout(()=> window.location.href='receipt.html', 260);
});
</script>
</body>
</html>
